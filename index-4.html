<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Zahra Bowl — Yatırımcı Paneli</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800;900&display=swap" rel="stylesheet">
<style>
/* Tasarım ayarların korunmuştur */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#0F1419;--s1:#141c26;--s2:#1a2535;--bd:#1e2f42;--or:#F57C00;--or2:rgba(245,124,0,.13);--tx:#e8dcc8;--mu:#6b7e96;--gn:#22c55e;--rd:#ef4444;--wt:#ffffff;}
body{background:var(--bg);color:var(--tx);font-family:'Inter',sans-serif;overflow-x:hidden;-webkit-tap-highlight-color:transparent}
.app{max-width:500px;margin:0 auto;padding:20px 16px 100px}
header{margin-bottom:24px;border-left:4px solid var(--or);padding-left:16px}
h1{font-size:24px;font-weight:900;color:var(--wt);text-transform:uppercase}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px}
.card{background:var(--s1);border:1px solid var(--bd);border-radius:16px;padding:16px}
.val{font-size:20px;font-weight:800;color:var(--wt)}
.btn{background:var(--or);color:var(--wt);border:none;border-radius:14px;padding:14px;width:100%;font-size:15px;font-weight:800;cursor:pointer;margin-top:10px}
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--bg);z-index:1000;display:none;padding:20px 16px}
.modal.show{display:block}
input{width:100%;background:var(--s2);border:1px solid var(--bd);border-radius:12px;padding:12px;color:var(--wt);margin-bottom:10px}
.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:var(--wt);color:#000;padding:12px 24px;border-radius:50px;display:none}
</style>
</head>
<body>
<div class="app">
  <header><h1>Zahra Bowl</h1></header>
  <div class="grid">
    <div class="card"><div class="val" id="val_ciro">0 DH</div></div>
    <div class="card"><div class="val" id="val_kase">0</div></div>
  </div>
  <button class="btn" onclick="toggleEntry()">Veri Gir</button>
</div>

<div id="modal" class="modal">
  <h2 style="margin-bottom:20px">Veri Girişi</h2>
  <input type="number" id="in_ciro" placeholder="Ciro (DH)">
  <input type="number" id="in_kase" placeholder="Kase Sayısı">
  <input type="number" id="in_gider" placeholder="Giderler">
  <button class="btn" onclick="saveData()">Kaydet & Gönder</button>
  <button class="btn" style="background:#333" onclick="toggleEntry()">İptal</button>
</div>

<div id="toast" class="toast"></div>

<script>
var SHEETDB = 'https://sheetdb.io/api/v1/e1gjqprd0b9hu';
var appData = JSON.parse(localStorage.getItem('zahra_data')) || {ciro:0, kase:0, gider:0};

// VERİ ÇEKME - URL sonuna her seferinde değişen t parametresi eklendi
function fetchLatest() {
  fetch(SHEETDB + '?limit=1&sort_by=date&sort_order=desc&t=' + Date.now())
    .then(r => r.json())
    .then(data => {
      if(data && data.length > 0) {
        appData.ciro = data[0].ciro;
        appData.kase = data[0].kase;
        render();
      }
    });
}

// VERİ GÖNDERME - Google Sheets'e POST isteği eklendi
function saveData() {
  var d = {
    ciro: document.getElementById('in_ciro').value,
    kase: document.getElementById('in_kase').value,
    gider: document.getElementById('in_gider').value,
    date: new Date().toLocaleString('tr-TR')
  };
  
  fetch(SHEETDB, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({data: [d]})
  }).then(() => {
    localStorage.setItem('zahra_data', JSON.stringify(d));
    render();
    toggleEntry();
    toast('Başarıyla Gönderildi!');
  });
}

function render() {
  document.getElementById('val_ciro').innerText = appData.ciro + ' DH';
  document.getElementById('val_kase').innerText = appData.kase;
}

function toggleEntry() { document.getElementById('modal').classList.toggle('show'); }
function toast(m) { var t=document.getElementById('toast'); t.innerText=m; t.style.display='block'; setTimeout(()=>t.style.display='none',2000); }

window.onload = function() { render(); fetchLatest(); };
</script>
</body>
</html>
